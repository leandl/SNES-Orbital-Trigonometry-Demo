# ğŸŒŒ SNES Orbital Trigonometry Demo

Este Ã© um projeto de demonstraÃ§Ã£o para Super Nintendo (SNES) que simula a Ã³rbita da lua ao redor da Terra usando funÃ§Ãµes trigonomÃ©tricas (`sin` e `cos`).  
Inspirado no vÃ­deo do GameDevBoss sobre Ã³rbitas no Mega Drive:  
ğŸ¥ [SGDK 2.10 - Minha contribuiÃ§Ã£o mudou tudo! O que eu fiz??? (YouTube)](https://www.youtube.com/watch?v=EkLGyghS1Vc)

![DemonstraÃ§Ã£o orbital](assets/orbital-demo.gif)

## âœ¨ Funcionalidades

- ğŸŒ• Lua orbitando a Terra com movimento elÃ­ptico ajustÃ¡vel.
- ğŸ® Cursor controlÃ¡vel via controle SNES que tambÃ©m orbita a Terra.
- ğŸ› ï¸ Estrutura modular com `Earth`, `Moon`, `Cursor` e utilitÃ¡rios matemÃ¡ticos.

## ğŸ§® Sistema TrigonomÃ©trico Customizado

Para simular o movimento orbital sem o uso de ponto flutuante (nÃ£o suportado nativamente pelo SNES), o projeto utiliza uma **tabela de lookup** para `seno` de 0Â° a 90Â°, com valores inteiros de 0 a 1000 (representando 0.0 a 1.0). A partir disso, as funÃ§Ãµes `sin` e `cos` sÃ£o construÃ­das com base na simetria dos quadrantes:

### ğŸ”¢ Tabela de Seno (`all_angle[91]`)

| Ã‚ngulo | Valor Inteiro | Valor Aproximado |
| ------ | ------------- | ---------------- |
| 0Â°     | 0             | 0.0              |
| 30Â°    | 500           | 0.5              |
| 90Â°    | 1000          | 1.0              |

Essa tabela reduz o custo computacional e evita cÃ¡lculos de ponto flutuante em tempo real.

### ğŸ§  FunÃ§Ãµes TrigonomÃ©tricas

- `s16 sin(u16 angle)`  
  Calcula o seno com base na tabela, usando simetria dos quadrantes (0â€“359Â°).
- `s16 cos(u16 angle)`  
  Calcula o cosseno reutilizando o seno: `cos(x) = sin(x + 90Â°)`.
- `void TrigonometryOrbital_computePositionEx(...)`  
  Calcula a posiÃ§Ã£o X/Y de um objeto orbitando outro com:

  - Ã¢ngulo
  - distÃ¢ncia
  - ponto de referÃªncia
  - escala nos eixos X e Y (achatamento para elipse)

- `void TrigonometryOrbital_computePosition(...)`  
  Calcula a posiÃ§Ã£o X/Y de um objeto orbitando outro com:
  - Ã¢ngulo
  - distÃ¢ncia
  - ponto de referÃªncia

Essa abordagem permite criar Ã³rbitas **circulares ou elÃ­pticas** em tempo real com alta performance.

### âœ¨ Exemplo de uso da Ã³rbita:

```c
u16 cursor_x, cursor_y;
TrigonometryOrbital_computePosition(
  &cursor_x,
  &cursor_y,
  earth.x + 16,  // centro da Terra
  earth.y + 16,
  cursor.angle,
  40             // raio orbital
);
```

### ğŸ” Escala ElÃ­ptica

Se quiser simular uma Ã³rbita achatada (como uma elipse), use a funÃ§Ã£o `TrigonometryOrbital_computePositionEx` passando `x_scale` e `y_scale` com valores diferentes de 100.

```c
u16 moon_x, moon_y;
TrigonometryOrbital_computePositionEx(
  &moon_x,
  &moon_y,
  earth.x + 16,
  earth.y + 16,
  moon.angle,
  50,
  120, // x_scale
  80   // y_scale
);
```

## âš™ï¸ Requisitos

- [Docker](https://www.docker.com/)
- [Node.js](https://nodejs.org/) _(opcional â€” usado para facilitar a execuÃ§Ã£o do build via script)_
- `pvsneslib` instalada em um diretÃ³rio anterior ao `workdir` do projeto

## ğŸ“¦ InstalaÃ§Ã£o da `pvsneslib`

Antes de compilar o projeto, vocÃª precisa ter a biblioteca [`pvsneslib`](https://github.com/alekmaul/pvsneslib) instalada.  
VocÃª pode baixÃ¡-la diretamente atravÃ©s da pÃ¡gina de releases oficiais:

ğŸ”— **[Download da pvsneslib (Releases)](https://github.com/alekmaul/pvsneslib/releases)**

> ApÃ³s o download, descompacte a lib em um diretÃ³rio anterior ao do seu projeto para que a estrutura fique assim:
>
> ```
> /seu-workspace/
> â”œâ”€â”€ pvsneslib/
> â””â”€â”€ seu-projeto/
> ```

## ğŸš€ Como rodar

### Usando Node.js

Se vocÃª tiver o Node.js instalado, pode rodar:

```bash
npm run pvsneslib:build
```

### Usando apenas Docker

Se nÃ£o tiver o Node.js instalado:

```bash
docker compose -f infra/compose.yaml up
```

## ğŸ“¦ Estrutura do Projeto

```
â”œâ”€â”€ infra/
â”‚ â”œâ”€â”€ Dockerfile
â”‚ â””â”€â”€ compose.yaml           # Docker Compose para build automatizado
â”œâ”€â”€ assets/
â”‚ â””â”€â”€ orbital-demo.png       # Imagem ilustrativa da simulaÃ§Ã£o
â”œâ”€â”€ res/
â”‚ â”œâ”€â”€ gfx/
â”‚ â”‚ â””â”€â”€ bg.png               # Imagem do Background
â”‚ â””â”€â”€ sprite/
â”‚     â””â”€â”€ spr_all.png        # Imagem com Todos os Sprites
â”œâ”€â”€ src/
â”‚ â”œâ”€â”€ core/
â”‚ â”‚ â”œâ”€â”€ background.h/.c        # Gerenciamento do background
â”‚ â”‚ â”œâ”€â”€ palette_sprite.h/.c    # Paletas de cor para sprites
â”‚ â”‚ â””â”€â”€ storage_sprite.h/.c    # Carregamento e gerenciamento de sprites
â”‚ â”œâ”€â”€ math/
â”‚ â”‚ â””â”€â”€ trigonometry.h/.c      # FunÃ§Ãµes trigonomÃ©tricas personalizadas
â”‚ â”œâ”€â”€ main.c                   # Entrada principal do jogo
â”‚ â”œâ”€â”€ earth.h/.c               # LÃ³gica da Terra
â”‚ â”œâ”€â”€ moon.h/.c                # LÃ³gica da Lua
â”‚ â””â”€â”€ cursor.h/.c              # LÃ³gica do cursor controlÃ¡vel
â”œâ”€â”€ .env                       # VariÃ¡veis de Ambiente: Nome da ROM e Modo Debug
â”œâ”€â”€ data.asm
â”œâ”€â”€ hdr.asm
â”œâ”€â”€ Makefile
â”œâ”€â”€ README.md
â””â”€â”€ trigonometry.sfc           # DemonstraÃ§Ã£o
```

## ğŸ™Œ CrÃ©ditos

- ğŸ® **[pvsneslib](https://github.com/alekmaul/pvsneslib)** â€“ Biblioteca base para desenvolvimento SNES em C.
- ğŸ¥ **GameDevBoss** â€“ Pela inspiraÃ§Ã£o e explicaÃ§Ã£o sobre Ã³rbitas no Mega Drive.  
  VÃ­deo: [SGDK 2.10 - Minha contribuiÃ§Ã£o mudou tudo!](https://www.youtube.com/watch?v=EkLGyghS1Vc)

---

Sinta-se livre para estudar, modificar e expandir!

ğŸ› ï¸ Made with â¤ï¸ e nostalgia.
